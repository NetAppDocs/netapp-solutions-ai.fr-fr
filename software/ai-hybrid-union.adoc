---
sidebar: sidebar 
permalink: software/ai-hybrid-union.html 
keywords: NetApp AI, AI, Artificial Intelligence, ML, Machine Learning, Union.ai, Hybrid AI training 
summary: 'D√©ployez un environnement d"entra√Ænement d"IA hybride utilisant l"orchestration Union.ai avec NetApp FlexCache pour permettre aux charges de travail d"entra√Ænement GPU bas√©es sur le cloud d"acc√©der aux donn√©es sur site de mani√®re efficace et s√©curis√©e.' 
---
= D√©ployez une formation hybride en IA avec Union.ai et NetApp FlexCache
:allow-uri-read: 


[role="lead"]
D√©couvrez comment d√©ployer un environnement de formation IA hybride en utilisant l'orchestration Union.ai avec NetApp FlexCache et Trident pour le provisionnement du stockage Kubernetes.

David Espejo, Union.ai Sathish Thyagarajan, NetApp



== Aper√ßu

La plateforme d'orchestration hybride d'Union.ai s'int√®gre parfaitement √† NetApp ONTAP et FlexCache pour acc√©l√©rer les flux de travail d'entra√Ænement IA/ML.  Cette solution permet de conserver les donn√©es en toute s√©curit√© sur site tout en tirant parti de la puissance de calcul GPU bas√©e sur le cloud pour les charges de travail d'entra√Ænement de l'IA.  NetApp FlexCache garantit que seules les donn√©es n√©cessaires sont mises en cache dans le cloud, permettant ainsi des pipelines d'IA/ML hybrides efficaces, s√©curis√©s et √©volutifs.



== Cas d'utilisation client¬†: Formation √† l'IA dans le cloud hybride

* Donn√©es sur site¬†: stock√©es sur NetApp ONTAP pour des raisons de conformit√© et de s√©curit√©.
* Calcul en nuage¬†: Entra√Ænement GPU √©volutif sur EKS/GKE/AKS.
* Orchestration IA/ML¬†: Union.ai coordonne le traitement des donn√©es et l‚Äôentra√Ænement dans diff√©rents environnements.
* Provisionnement du stockage¬†: NetApp Trident automatise le provisionnement des PVC/PV.




== Valeur client

* Ex√©cutez des charges de travail d'IA sur des ensembles de donn√©es massifs gr√¢ce aux capacit√©s d'extension horizontale de NetApp ONTAP.
* D√©placez et synchronisez des donn√©es entre votre infrastructure sur site et le cloud gr√¢ce aux fonctionnalit√©s de cloud hybride de NetApp.
* Mettez rapidement en cache les donn√©es sur site dans le cloud gr√¢ce √† FlexCache.
* Union.ai simplifie l'orchestration entre environnements gr√¢ce au versionnage, au suivi de la lign√©e et √† la gestion des artefacts.
* Effectuez des formations dans le cloud tout en conservant les donn√©es sensibles sur site.




== Activation du plugin ‚Äì Pr√©requis

[cols="32%,68%"]
|===


| *Exigence* | *D√©tails* 


| Version ONTAP | ONTAP 9.7+ (Licence FlexCache non requise) 


| Licence FlexCache | Requis sur ONTAP 9.6 et versions ant√©rieures 


| Kubernetes | Clusters sur site et dans le cloud (EKS/GKE/AKS) 


| Trident | Install√© sur les clusters sur site et dans le cloud 


| Union.ai | Plan de contr√¥le d√©ploy√© (Union Cloud ou auto-h√©berg√©) 


| R√©seautage | Connectivit√© inter-clusters (si les clusters ONTAP sont s√©par√©s) 


| Autorisations  a| 
Acc√®s administrateur aux clusters ONTAP et Kubernetes.

‚úÖUtilisez les identifiants ONTAP corrects (par exemple, vsadmin).



| Vous d√©couvrez Union.ai ? | Consultez le guide d'accompagnement √† la fin de ce document. 
|===


== Architecture de r√©f√©rence

La figure suivante illustre le plan de contr√¥le Union.ai int√©gr√© au stockage NetApp pour l'entra√Ænement hybride en IA.

image::ai-hybrid-union-001.png[Architecture hybride de formation d'IA avec Union.ai et NetApp]

* Plan de contr√¥le Union.ai¬†: orchestre les flux de travail, g√®re les d√©placements de donn√©es et s‚Äôint√®gre aux API NetApp .
* NetApp ONTAP + FlexCache: Assure une mise en cache efficace des donn√©es, sur site et dans le cloud.
* Clusters d'entra√Ænement hybrides¬†: les t√¢ches d'entra√Ænement s'ex√©cutent dans des clusters K8s cloud (par exemple, EKS) avec des donn√©es mises en cache √† partir de l'environnement sur site.




=== _√âtape 1 : Cr√©er un volume FlexCache

Utilisation du gestionnaire de syst√®me ONTAP

. Acc√©dez √† Stockage > Volumes.
. Cliquez sur Ajouter.
. S√©lectionnez Plus d'options.
. Activer l'option ¬´ Ajouter comme cache pour un volume distant ¬ª.
. Choisissez vos volumes source (sur site) et de destination (cloud).
. D√©finir le niveau de QoS ou de performance (facultatif).
. Cliquez sur Cr√©er.


üí°Si le kit d'outils NetApp DataOps ne fonctionne pas en raison de probl√®mes d'autorisation ou d'agr√©gation, cr√©ez directement le volume FlexCache √† l'aide ONTAP System Manager ou de l'interface de ligne de commande (CLI).



=== _√âtape 2 : Configurer Trident_

Installez Trident sur les deux clusters¬†:

üîó https://docs.netapp.com/us-en/trident/trident-get-started/kubernetes-deploy.html["+++ Guide d'installation de Trident +++"]

Cr√©er un backend Trident

[source, cli]
----
apiVersion: trident.netapp.io/v1
kind: TridentBackendConfig
metadata:
name: ontap-flexcache
spec:
version: 1
storageDriverName: ontap-nas
managementLIF: <ONTAP-MGMT-IP>
dataLIF: <ONTAP-DATA-IP>
svm: <SVM-NAME>
username: vsadmin
password: <password>

Apply: kubectl apply -f backend-flexcache.yaml
----
Si vous recevez une erreur 401 Non autoris√©, v√©rifiez que l'utilisateur ONTAP dispose des autorisations API suffisantes et que le nom d'utilisateur (vsadmin) et le mot de passe corrects sont utilis√©s.

D√©finir la classe de stockage

[source, cli]
----
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
name: flexcache-sc
provisioner: csi.trident.netapp.io
parameters:
backendType: "ontap-nas"
Apply:
kubectl apply -f storageclass-flexcache.yaml
----


=== _√âtape 3¬†: D√©ploiement des workflows Union.ai_

Union utilise des PVC pour monter les volumes FlexCache dans les t√¢ches d'entra√Ænement.

Exemple de PodTemplate

[source, cli]
----
apiVersion: v1
kind: PodTemplate
metadata:
name: netapp-podtemplate
namespace: flytesnacks-development
template:
metadata:
labels:
default-storage: netapp
spec:
containers:
- name: primary
volumeMounts:
- name: flexcache-storage
mountPath: /data/flexcache
volumes:
- name: flexcache-storage
persistentVolumeClaim:
claimName: flexcache-pvc
----
Exemple de flux de travail

t√¢che d'importation d'union, flux de travail

[source, cli]
----
@task(pod_template="netapp-podtemplate")

def train_model(pvc_path: str):
----


= Chargez et entra√Ænez-vous sur les donn√©es provenant du PVC.

[source, cli]
----
@workflow

def training_pipeline():

train_model(pvc_path="/data/flexcache")
----
L'op√©rateur syndiqu√© va :

* Cr√©er le PVC
* Monter le volume FlexCache
* Planifiez la t√¢che dans le cluster K8s du cloud




=== √âtape 4 : Valider l'int√©gration

[cols="21%,79%"]
|===
| *T√¢che* | *Validation* 


| Support en PVC | Les modules d'entra√Ænement devraient monter /data/flexcache avec succ√®s 


| Acc√®s aux donn√©es | Les t√¢ches de formation peuvent lire/√©crire dans FlexCache 


| Comportement du cache | Surveiller les succ√®s/√©checs du cache dans ONTAP.  Assurez-vous que les agr√©gats prennent en charge FlexCache. 


| Performances | Valider la latence et le d√©bit pour les charges de travail d'entra√Ænement 
|===
Utilisez NetApp BlueXP ou l'interface de ligne de commande ONTAP pour surveiller les performances.



== Consid√©rations de s√©curit√©

* Utiliser les points de terminaison VPC pour FSx pour NetApp ONTAP
* Activer le chiffrement en transit et au repos
* Appliquer RBAC/IAM pour l'acc√®s ONTAP
* Union.ai n'acc√®de pas aux donn√©es des clients et ne les stocke pas.




== Surveillance et optimisation

[cols="31%,69%"]
|===


| *Outil* | *But* 


| NetApp BlueXP | Surveiller l'utilisation et les performances de FlexCache 


| Union.ai UI | Suivi de l'√©tat et des indicateurs du pipeline 


| Bois de Trident | D√©boguer les probl√®mes de PVC ou de backend 
|===
*Am√©liorations optionnelles*

* Automatisation de la cr√©ation de FlexCache √† l'aide des API BlueXP
* Utilisez le SDK Union pour initialiser le cache avant l'entra√Ænement.
* Ajouter des pipelines d'inf√©rence par lots ou de d√©ploiement de mod√®les apr√®s l'entra√Ænement
* Si DataOps Toolkit √©choue, utilisez la cr√©ation manuelle de FlexCache via System Manager.


*D√©pannage*

[cols="41%,59%"]
|===
| _Probl√®me_ | _R√©solution_ 


| PVC bloqu√© en attente | V√©rifiez les journaux Trident et la configuration du backend 


| 401 Non autoris√© depuis l'API ONTAP | Utilisez vsadmin et v√©rifiez les permissions. 


| √âchec de l'op√©ration¬†: aucun espace de stockage appropri√©. | Assurez-vous que l'agr√©gat ONTAP prend en charge FlexCache/ FabricPool 


| Performances d'entra√Ænement lentes | V√©rifier le taux d'acc√®s au cache et la latence du r√©seau 


| Les donn√©es ne se synchronisent pas. | Valider l'int√©grit√© des relations FlexCache dans ONTAP 
|===
*Prochaines √©tapes*

. Valider FlexCache avec des donn√©es de test
. D√©ploiement des pipelines de formation Union.ai
. Surveiller et optimiser les performances
. Configuration sp√©cifique au client




== Liens connexes

* https://docs.union.ai["+++Documentation Union.ai+++"]
* https://docs.netapp.com/us-en/ontap/flexcache/index.html["+++ Pr√©sentation de NetApp FlexCache +++"]
* https://docs.netapp.com/us-en/trident/index.html["+++ Pilote Trident CSI+++"]
* https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/what-is-fsx-ontap.html["+++FSx pour NetApp ONTAP+++"]




== Conclusion

Vous disposez d√©sormais d'un environnement de formation hybride valid√© pour l'IA utilisant Union.ai et NetApp FlexCache.  Les t√¢ches de formation peuvent s'ex√©cuter dans le cloud tout en acc√©dant aux donn√©es sur site de mani√®re s√©curis√©e et efficace, sans avoir √† r√©pliquer des ensembles de donn√©es entiers ni √† compromettre la gouvernance.



=== *Union.ai - Guide d'utilisation*



==== *√âtape 1¬†: Choisir le mod√®le de d√©ploiement*

*Option A : Union Cloud*

* Visite: https://console.union.ai["+++console.union.ai+++"]
* Cr√©er une organisation ‚Üí Cr√©er un projet


*Option B : Auto-h√©berg√©*

* Suivre:https://docs.union.ai/platform/latest/deployment/self-hosted/["+++Guide auto-h√©berg√©+++"]
* D√©ploiement via Helm¬†:


helm repo ajouter unionai https://unionai.github.io/helm-charts/[]

helm install union unionai/union -n union-system -f values.yaml



==== *√âtape 2¬†: Installer l‚Äôop√©rateur syndical*

**Ó∞É**kubectl apply -fhttps://raw.githubusercontent.com/unionai/operator/main/deploy/operator.yaml[]

kubectl get pods -n union-system

Ó∞Ç



==== *√âtape 3¬†: Installer Union CLI*

**Ó∞É**pip install unionai

Connexion √† l'union

Ó∞Ç



==== *√âtape 4¬†: Enregistrement du flux de travail*

**Ó∞É** Projet d'union pour cr√©er une IA hybride

union register training_pipeline.py --project hybrid-ai

Ó∞Ç



==== *√âtape 5¬†: Ex√©cuter et surveiller*

**union run training_pipeline --project hybrid-ai

formation de la surveillance syndicale_pipeline

Ó∞ÇConsultez les journaux dans le https://console.union.ai["+++Union UI+++"]



==== *√âtape 6¬†: Enregistrement du cluster de calcul (facultatif)*

**Ó∞É**Union Cluster Register --name cloud-k8s --kubeconfig ~/.kube/config



==== *√âtape 7¬†: Suivi des artefacts et de leur lign√©e*

L'Union effectue automatiquement le suivi¬†:

* Param√®tres d'entr√©e/sortie
* Versions de donn√©es
* Journaux et m√©triques
* lign√©e d'ex√©cution

